<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.moshu.trainplatform.mapper.RecordMapper">

    <select id="listRecord" resultType="com.moshu.trainplatform.vo.RecordVO">
        # count(s.id)统计 `soil_sample`.`id`不为空的行数，对应左关联
        SELECT r.`id`,
               `username`,
               `user_id`,
               COUNT(s.id) AS 'count',
               `status`,
               `submit_time`,
               r.`create_time`,
               r.`update_time`
        FROM `record` r
                 LEFT JOIN `soil_sample` s ON r.`id` = s.`record_id`
        GROUP BY `username`
    </select>

    <select id="listRecordByUserId" resultType="com.moshu.trainplatform.vo.RecordVO" parameterType="java.lang.String">
        SELECT r.`id`,
               `username`,
               r.`user_id`,
               COUNT(s.id) AS 'count',
               `status`,
               `submit_time`,
               r.`create_time`,
               r.`update_time`
        FROM `record` r
                 LEFT JOIN `soil_sample` s ON r.`id` = s.`record_id`
        WHERE `user_id` = #{userId}
        GROUP BY `username`
    </select>


</mapper>